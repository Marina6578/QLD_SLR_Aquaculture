---
title: "Compair affected v soriginal areas"
output: Comparison of affected by Flood leased areas vs Original Leased Areas and percentage
date: "2023-08-09"
---

```{r}
library(tidyverse)
library(here)
library(tmap)
library(sf)
library(ggplot2)
library(dplyr)
```
#first I am going to add a column to the shapefile dataset that has the intersected areas resulting from the flood and erosion map created by the Queensland Governmentand the leased aquaculture areas to calculate the areas of the intersection polygons (know the amount of area is in the polygons of the intersection)

#load the data of my dataset shapefile

```{r}
qld_leases_erosion_data <- st_read(here("output_data/qld_leases_erosion.shp"))
```

#create a new column without data (all 0)
```{r}
qld_leases_erosion_data <- qld_leases_erosion_data %>%
  mutate(Affected_Area = st_area(qld_leases_erosion_data))
```

#save shapefile with area calculations (affectedArea) of the intersected bits
```{r}
st_write(qld_leases_erosion_data, here("output_data/qld_leases_erosion_data.shp"), delete_layer = TRUE)
```
#secondly I am going to add a column to the shapefile dataset that I had originally from the leased area flor aquacultire in Queensland and them calculate the size of the leased polygons. I am loading the dataset of ersoions just because I will want later to use it for the comparison


#load the data of both my datasets in shapefile (original leased areas for aquaculture and the intersection of flooded areas within the leased areas)
```{r}
qld_leases_erosion_data <- st_read(here("output_data/qld_leases_erosion.shp"))
qld_leases<-st_read(here("raw_data/QLD_aqua_ground_truth/QLD_terr_aquaculture_ground_truth.shp"))
```

#reproject data of the queensland leases (erosion data was done after reprojecting beforehand when I created it)
```{r}
qld_leases_reproj<-st_transform(qld_leases, 3577)
```

#create new dataset for qld_leases_data to manipulate
```{r}
qld_leases_data <-qld_leases_reproj
```

#create a new column without data (all 0)
```{r}
qld_leases_data <- qld_leases_data %>%
  mutate(Area = st_area(.),
         Propaffectedarea=)
```



#save shapefile with area calculations (affectedArea) of the intersected bits
```{r}
st_write(qld_leases_data, here("output_data/qld_leases_data.shp"), delete_layer = TRUE)
```
#COMPARISON TIME!!!
#set IDs for each lease to be the common thing between both datasets from comparison
```{r}
IDs<-qld_leases_erosion_data$qldglb_
OriginalIDs<-qld_leases_data$qldglb_
```

#add another column to be the comparison of Areas as a percentage
```{r}
qld_leases_data <- qld_leases_data %>%
  mutate(Percentage_Area = 0)
```
# set up the loop for the comparison of Areas in original Leased aquaculture vs affected (flooded) parts of the lease for each index (line)

```{r}
j=1
for (x in IDs) {
  index <- which(OriginalIDs == x)
  cat("Target value found at index", index, "\n")
    }

```
#need to compare for each ID/Original ID the AfArea/OriginalArea and put it the the qld_leases_data$Percentage_Area
#tried many things and it didnt work such as qld_leases_data$Percentage_Area[index]<-AfArea[i]/OriginalArea[index] and after doing that get values of affected area in the same dataset qld_leases_data. 